function aws-ssh() {
  if [ "$1" == "" ]; then
      echo "Unable to login to AWS; No host given" >&2
      return 1
  fi

  if [ -e "$HOME/.ssh/aws.pem" ]; then
    local IDENTITY="$HOME/.ssh/aws.pem"
    local EC2_USER=ec2-user
  else
    local IDENTITY="$HOME/.ssh/id_rsa"
    local EC2_USER=$USER
  fi

  echo ssh -i $IDENTITY -o "UserKnownHostsFile /dev/null" -o StrictHostKeyChecking=no $EC2_USER@$1
  ssh -i $IDENTITY -o "UserKnownHostsFile /dev/null" -o StrictHostKeyChecking=no $EC2_USER@$1
}

function aws-scp() {
  if [ "$2" == "" ]; then
      echo "Unable to login to AWS; No host given" >&2
      return 1
  fi
  scp -i ~/.ssh/aws.pem -o StrictHostKeyChecking=no $1 ec2-user@$2:~
}

function aws-scp-hosts() {
  local file=$1
  shift

  for host in $@; do
    aws-scp $file $host
  done
}

function whirrly() {
  if [ $# -lt 2 ]; then
      echo "Unable to run whirr command, need a function and config file!" >&2
      return 1
  fi

  COMMAND=$1
  shift
  CONFIG=$1
  shift

  export WHIRR_HOME=${WHIRR_HOME:-/usr/local/whirr/current}


  if [ -e $WHIRR_HOME/recipes/$CONFIG ]; then
    CONFIG_FILE=$WHIRR_HOME/recipes/$CONFIG
  else
    CONFIG_FILE=$CONFIG
  fi

  ${WHIRR_HOME}/bin/whirr $COMMAND --config $CONFIG_FILE $@
}
